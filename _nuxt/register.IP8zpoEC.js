import{T as B}from"./components.FNtWaweb.js";import{_ as F}from"./nuxt-link.cftfJ_Uw.js";import{u as N}from"./use-api.KTCvbQcm.js";import{_ as P,z as O,A as j,v as c,B as E,o as T,c as k,b as r,w as I,d as v,a as e,n as h,j as s,C as V,D as b,F as S,t as z,q as A,E as D,p as L,e as R}from"./entry.VGLBRfk-.js";import"./vue.f36acd1f.p9cEaaxm.js";import"./index.q7pdzPxW.js";import"./index.XjgyyoPU.js";const l=x=>(L("data-v-89c935a2"),x=x(),R(),x),G={class:"form-background"},H={class:"form"},J=l(()=>e("h1",{class:"form-title text-center"},"注册",-1)),K=l(()=>e("span",{class:"form-input-label"},"用户名",-1)),M=l(()=>e("span",{class:"form-input-focus"},null,-1)),Q=l(()=>e("span",{class:"form-input-label"},"密码",-1)),W=l(()=>e("span",{class:"form-input-focus"},null,-1)),X=l(()=>e("span",{class:"form-input-label"},"重复密码",-1)),Y=l(()=>e("span",{class:"form-input-focus"},null,-1)),Z=l(()=>e("span",{class:"form-input-label"},"邮箱",-1)),$=l(()=>e("span",{class:"form-input-focus"},null,-1)),ee=l(()=>e("span",{class:"form-input-label"},"验证码",-1)),se=l(()=>e("span",{class:"form-input-focus"},null,-1)),te=["disabled"],oe={class:"form-text mt-12 text-center"},le={__name:"register",setup(x){const g=N(),C=O(),f=j();let n=c(""),u=c(""),_=c(""),a=c(""),i=c(""),d=c(0),m=null;E(()=>{m&&(clearInterval(m),m=null)});function U(){C.validate().then(({valid:y,results:o,errors:p})=>{if(!y){f.error(Object.values(p)[0]);return}g("/register",{method:"POST",body:{name:n.value,password:u.value,email:a.value,verifyCode:i.value}}).then(w=>{w.code===0?(f.success("您已成功注册！即将跳转至登录界面"),D("/user/login")):f.error("注册失败！"+w.msg)})})}function q(){C.validateField("email").then(({valid:y,errors:o})=>{if(!y){f.error(Object.values(o)[0]);return}g("/sendVerifyCode",{method:"POST",body:{type:1,email:a.value}}).then(p=>{p.code==0?(d.value=60,m=setInterval(()=>{d.value>0?d.value--:(clearInterval(m),m=null)},1e3)):f.error("验证码发送失败！"+p.msg)})})}return(y,o)=>{const p=B,w=F;return T(),k(S,null,[r(p,null,{default:I(()=>[v("注册")]),_:1}),e("main",G,[e("form",H,[J,e("div",{class:h(["form-input mt-12",{"has-value":s(n)}])},[K,r(s(b),{class:"form-input-text",type:"text",name:"username",placeholder:"不超过 16 位，不能有特殊字符",modelValue:s(n),"onUpdate:modelValue":o[0]||(o[0]=t=>V(n)?n.value=t:n=t),rules:"required|username"},null,8,["modelValue"]),M],2),e("div",{class:h(["form-input mt-4",{"has-value":s(u)}])},[Q,r(s(b),{class:"form-input-text",type:"password",name:"password",placeholder:"6-20 位，至少包含数字、字母和符号中的两种",modelValue:s(u),"onUpdate:modelValue":o[1]||(o[1]=t=>V(u)?u.value=t:u=t),rules:"required|password|confirmed:@repeatedPassword"},null,8,["modelValue"]),W],2),e("div",{class:h(["form-input mt-4",{"has-value":s(_)}])},[X,r(s(b),{class:"form-input-text",type:"password",name:"repeatedPassword",placeholder:"请再输入一次密码",modelValue:s(_),"onUpdate:modelValue":o[2]||(o[2]=t=>V(_)?_.value=t:_=t)},null,8,["modelValue"]),Y],2),e("div",{class:h(["form-input mt-4",{"has-value":s(a)}])},[Z,r(s(b),{class:"form-input-text",type:"text",name:"email",placeholder:"登录账号所需的邮箱",modelValue:s(a),"onUpdate:modelValue":o[3]||(o[3]=t=>V(a)?a.value=t:a=t),rules:"required|email"},null,8,["modelValue"]),$],2),e("div",{class:h(["form-input verify mt-4",{"has-value":s(i)}])},[ee,r(s(b),{class:"form-input-text",type:"text",name:"verifyCode",placeholder:"发送至邮箱的验证码",modelValue:s(i),"onUpdate:modelValue":o[4]||(o[4]=t=>V(i)?i.value=t:i=t),rules:"required|digits:6"},null,8,["modelValue"]),se,e("button",{class:"form-button",type:"button",disabled:s(d)>0,onClick:q},[v(" 发送验证码 "),s(d)?(T(),k(S,{key:0},[v(" ("+z(s(d))+" 秒)",1)],64)):A("",!0)],8,te)],2),e("button",{class:"form-button mt-6",type:"button",onClick:U},"注册"),e("p",oe,[v(" 有账号了？ "),r(w,{class:"form-link",to:"/user/login"},{default:I(()=>[v("点此登录")]),_:1})])])])],64)}}},pe=P(le,[["__scopeId","data-v-89c935a2"]]);export{pe as default};
